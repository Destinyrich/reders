this.OMP=this.OMP||{},this.OMP.smartWidget=function(){"use strict";var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};var t=function(){return(t=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){var t={exports:{}};return e(t,t.exports),t.exports}var o,n=r((function(e,t){var r=i&&i.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<i;t++)for(var n=arguments[t],s=0,a=n.length;s<a;s++,o++)r[o]=n[s];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;var o=function(e){var t;if(e&&e.constructor)switch(e.constructor){case Error:t=e.stack;break;case Object:t=JSON.stringify(e,null,2);break;default:t=e}return t},n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e[1];if(e.length>2)for(var r=2;r<e.length;r++)i=i.replace("%s",o(e[r]));console[e[0]](i)};t.logger={log:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,r(["log"],e))},info:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,r(["info"],e))},error:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,r(["error"],e))},warn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,r(["warn"],e))}}})),s=r((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;var i=function(){function e(){this.events={},this.eventCount=0}return e.prototype.emit=function(e,t){if(void 0===t&&(t=""),e in this.events){var i=!1;this.events[e].forEach((function(e){e.fn.apply(null,[t]),e.emitOnce&&(i=!0)})),i&&(this.events[e]=this.events[e].filter((function(e){return!1===e.emitOnce})))}},e.prototype.on=function(e,t,i){void 0===i&&(i=!1),this.events.hasOwnProperty(e)||(this.events[e]=[]),this.events[e].some((function(e){return e.fn===t}))||this.events[e].push({id:this.eventCount++,emitOnce:i,fn:t})},e.prototype.off=function(e,t){this.events[e]=this.events[e].filter((function(e){return e.fn!==t}))},e.prototype.once=function(e,t){this.on(e,t,!0)},e}();t.EventEmitter=i})),a={logger:n.logger,EventEmitter:s.EventEmitter};!function(e){e.READY="READY",e.INIT_ERROR="INIT_ERROR",e.DATA="DATA",e.IFRAME_WIDGET_INITIALIZED="IFRAME_WIDGET_INITIALIZED",e.OPEN_WINDOW="OPEN_WINDOW",e.WINDOW_OPENED="WINDOW_OPENED"}(o||(o={}));var l,h=function(){function e(e,t){void 0===t&&(t=""),this.initialized=!1,this.ready=!1,this.hasRequestedIFrameReload=!1,this.iFrameResponseCheckInterval=null,this.iFrameResponseTimeout=10,this.iFrameMaxReloadCount=1,this.debug=!1,this.allowPopups=!1,this.reusePopupWindow=!1,this.popupReference=null,this.iFrameStyle={width:"0",height:"0",top:"0",left:"0",position:"relative",zIndex:"1000"},this.eventEmitter=e;var i=this.extractDomain(t);if(null===i)throw new Error("Invalid iFrameUrl domain");this.trustedDomain=i,this.iFrameUrl=t}return e.prototype.injectIFrame=function(){this.log("Injecting iFrame with URL: %s",this.iFrameUrl),this.iFrame=document.createElement("iframe"),this.iFrame.src=this.iFrameUrl,this.iFrame.setAttribute("id",this.makeUniqueId("omp-widget-iframe")),this.iFrame.setAttribute("referrerPolicy","strict-origin"),this.iFrame.style.display="none",this.iFrame.style.position=this.iFrameStyle.position,this.iFrame.style.width=this.iFrameStyle.width,this.iFrame.style.height=this.iFrameStyle.height,this.iFrame.style.top=this.iFrameStyle.top,this.iFrame.style.left=this.iFrameStyle.left,this.iFrame.style.zIndex=this.iFrameStyle.zIndex,this.iFrame.style.border="0",this.iFrame.setAttribute("sandbox","allow-scripts allow-same-origin"),document.body.appendChild(this.iFrame),this.checkIFrameInitialization()},e.prototype.checkIFrameInitialization=function(){var e=this;this.log("Waiting %s seconds for iFrame to load..",this.iFrameResponseTimeout),this.iFrameResponseCheckInterval=window.setTimeout((function(){e.iFrameMaxReloadCount>0?(e.log("Will retry loading the iFrame"),e.iFrame.src=e.iFrameUrl,e.iFrameMaxReloadCount--,e.checkIFrameInitialization()):(e.log("iFrame failed to load, check the URL: %s, is the user authenticated?",e.iFrameUrl),e.emit(o.INIT_ERROR,"iFrame took too long to respond"))}),1e3*this.iFrameResponseTimeout)},e.prototype.makeUniqueId=function(e){for(var t=e,i=1;document.getElementById(t);)t=e+"-"+i,i++;return t},e.prototype.openWindow=function(e){var t="omp-widget-top-window";this.reusePopupWindow||(this.popupReference=null,t=e),null===this.popupReference||this.popupReference&&this.popupReference.closed?this.popupReference=window.open(e,t):this.popupReference.location.href=e,this.popupReference&&this.popupReference.focus(),this.send(o.WINDOW_OPENED,e),this.emit(o.WINDOW_OPENED,e)},e.prototype.handleIFrameMessage=function(e){if(this.trustedDomain!==e.origin)return!1;switch(e.data.eventType||e.data.eventName){case o.IFRAME_WIDGET_INITIALIZED:window.clearInterval(this.iFrameResponseCheckInterval),this.hasRequestedIFrameReload?(this.hasRequestedIFrameReload=!1,this.log("iFrame re-loaded successfully"),this.filterMessage(e.data.eventType,e.data.message)):(this.log("iFrame loaded successfully, widget is initialized"),this.send(o.READY,this.serviceParameters),this.emit(o.READY),this.ready=!0);break;case o.OPEN_WINDOW:this.allowPopups&&this.openWindow(e.data.message);break;default:this.filterMessage(e.data.eventType,e.data.message)}},e.prototype.registerListeners=function(){window.addEventListener("message",this.handleIFrameMessage.bind(this),!1)},e.prototype.sendToIFrame=function(e,t){var i;void 0===t&&(t=""),null===(i=this.iFrame.contentWindow)||void 0===i||i.postMessage({eventType:e,message:t},this.iFrameUrl)},e.prototype.extractDomain=function(e){var t=null;try{var i=e.match(/^(https?:\/\/[^\/]+)/i);i&&(t=i[1])}catch(e){}return t},e.prototype.filterMessage=function(e,t){this.emit(e,t)},e.prototype.reloadIFrame=function(){this.hasRequestedIFrameReload=!0,this.iFrame.src=this.iFrameUrl+"?reload="+Date.now()},e.prototype.init=function(e,i){if(void 0===e&&(e={}),this.initialized)throw new Error("Widget has already been initialized");if(i){if(i.hasOwnProperty("debug")&&!0===i.debug&&(this.debug=!0,this.log("Supplied widget options: %s",i)),i.iFrameUrl){var r=this.extractDomain(i.iFrameUrl);if(null===r)throw this.log("Could not extract domain from supplied iFrameUrl: %s",i.iFrameUrl),new Error("Invalid iFrameUrl domain");this.iFrameUrl=i.iFrameUrl,this.trustedDomain=r,this.log("Setting iFrameUrl: %s",i.iFrameUrl),this.log("Setting trustedDomain from supplied iFrameUrl: %s",r)}i.iFrameStyle&&(this.iFrameStyle=t(t({},this.iFrameStyle),i.iFrameStyle),this.log("Setting iFrameStyle: %s",i.iFrameStyle)),"number"==typeof i.iFrameResponseTimeout&&(this.iFrameResponseTimeout=i.iFrameResponseTimeout,this.log("Setting iFrameResponseTimeout: %s",i.iFrameResponseTimeout)),i.trustedDomain&&(this.trustedDomain=i.trustedDomain,this.log("Setting trustedDomain: %s",i.trustedDomain)),i.hasOwnProperty("allowPopups")&&!0===i.allowPopups&&(this.allowPopups=i.allowPopups),i.hasOwnProperty("reusePopupWindow")&&!0===i.reusePopupWindow&&(this.reusePopupWindow=i.reusePopupWindow)}this.log("Supplied service parameters: %s",e),this.serviceParameters=e,this.registerListeners(),this.injectIFrame(),this.initialized=!0},e.prototype.send=function(e,t){this.sendToIFrame(e,t)},e.prototype.showIFrame=function(){this.iFrame.style.display="block"},e.prototype.hideIFrame=function(){this.iFrame.style.display="none"},e.prototype.emit=function(e,t){void 0===t&&(t=""),this.eventEmitter.emit(e,t),this.eventEmitter.emit(o.DATA,{status:e,message:t})},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.isWidgetOptions=function(e){return Object.keys(e).some((function(e){return["trustedDomain","iFrameUrl","debug"].includes(e)}))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.debug&&a.logger.info.apply(a.logger,e)},Object.defineProperty(e.prototype,"isInitialized",{get:function(){return this.initialized},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return this.ready},enumerable:!1,configurable:!0}),e}();!function(e){e.IFRAME_WIDGET_INITIALIZED="IFRAME_WIDGET_INITIALIZED",e.GET_USER_STATUS="GET_USER_STATUS",e.GET_ELIGIBLE_PROMO="GET_ELIGIBLE_PROMO",e.GET_SUBS_CATEGORY="GET_SUBS_CATEGORY",e.GET_TASTEMAKER_SUBS="GET_TASTEMAKER_SUBS",e.ELIGIBLE_PROMO="ELIGIBLE_PROMO",e.ELIGIBLE_PROMO_ERROR="ELIGIBLE_PROMO_ERROR",e.SUBS_CATEGORY="SUBS_CATEGORY",e.SUBS_CATEGORY_ERROR="SUBS_CATEGORY_ERROR",e.USER_STATUS="USER_STATUS",e.TASTEMAKER_SUBS="TASTEMAKER_SUBS",e.TASTEMAKER_SUBS_ERROR="TASTEMAKER_SUBS_ERROR",e.GET_OCM_CONTENT="GET_OCM_CONTENT",e.OCM_CONTENT="OCM_CONTENT",e.OCM_CONTENT_ERROR="OCM_CONTENT_ERROR",e.CANCEL_PRODUCT_INTENT="CANCEL_PRODUCT_INTENT",e.CANCEL_PRODUCT_INTENT_ERROR="CANCEL_PRODUCT_INTENT_ERROR",e.CANCEL_PRODUCT_CONFIRM="CANCEL_PRODUCT_CONFIRM",e.CANCEL_PRODUCT_CONFIRM_ERROR="CANCEL_PRODUCT_CONFIRM_ERROR",e.HAS_SUBSCRIPTION="HAS_SUBSCRIPTION"}(l||(l={}));var p=function(t){function i(e,i){var r=t.call(this,e,i)||this;return r.hasRequestedFreshUserStatus=!1,r.iFrameStyle={width:"100%",height:"100vh",top:"0",left:"0",position:"fixed",zIndex:"auto"},r}return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}(i,t),i.prototype.filterMessage=function(e,t){switch(e){case l.IFRAME_WIDGET_INITIALIZED:this.hasRequestedFreshUserStatus&&(this.hasRequestedFreshUserStatus=!1,this.getUserStatus());break;default:this.emit(e,t)}},i.prototype.getUserStatus=function(e){void 0===e&&(e=!1),e?(this.hasRequestedFreshUserStatus=!0,this.reloadIFrame()):this.send(l.GET_USER_STATUS)},i.prototype.getEligiblePromo=function(e){this.send(l.GET_ELIGIBLE_PROMO,e)},i.prototype.getSubscriptionCategory=function(e){this.send(l.GET_SUBS_CATEGORY,e)},i.prototype.getTastemakerSubscriptions=function(e){this.send(l.GET_TASTEMAKER_SUBS,e)},i.prototype.getOCMContent=function(e){this.send(l.GET_OCM_CONTENT,e)},i.prototype.cancelProductIntent=function(e){this.send(l.CANCEL_PRODUCT_INTENT,e)},i.prototype.cancelProductConfirm=function(e){this.send(l.CANCEL_PRODUCT_CONFIRM,e)},i.prototype.getHasSubscription=function(e){this.send(l.HAS_SUBSCRIPTION,e)},i.prototype.init=function(e,i){switch(arguments.length){case 0:t.prototype.init.call(this);break;case 1:e&&(this.isWidgetOptions(e)?t.prototype.init.call(this,{},e):t.prototype.init.call(this,e));break;default:t.prototype.init.call(this,e,i)}},i}(h);
// name: smart-widget client: yahoo, version: 2.1.4
return new p(new s.EventEmitter,"https://checkout.yahoo.com/swidget/v1/smart")}();
