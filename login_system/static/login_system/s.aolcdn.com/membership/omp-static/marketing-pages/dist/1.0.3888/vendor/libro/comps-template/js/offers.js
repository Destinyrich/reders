this.LIBRO=this.LIBRO||{},this.LIBRO.offers=function(e){"use strict";function t(){for(var t,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];e.store.debug&&(t=e.logger.tag("offers")).info.apply(t,function(e,t,r){if(r||2===arguments.length)for(var o,f=0,n=t.length;f<n;f++)!o&&f in t||(o||(o=Array.prototype.slice.call(t,0,f)),o[f]=t[f]);return e.concat(o||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,f,n=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(e){f={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return s}(r),!1))}function r(){window.innerWidth<800?e.dom.applyFunction(".offers__offer__desc",(function(e){return e.style.height="auto"})):e.dom.equalHeights(".offers__offer__desc")}function o(){var t=e.dom.getElement(".offers"),r=e.dom.getElement(".offers__teaser");e.dom.toggleClass(t,"offers--show",!e.dom.hasClass(t,"offers--show")),e.dom.toggleClass(r,"offers__teaser--hide",!e.dom.hasClass(r,"offers__teaser--hide"))}return e.dom.addListener(".offers__teaser",["click",o]),e.dom.addListener(".offers__container__close","click",o),window.addEventListener("resize",r),void e.store.once("OFFERS_DATA",(function(o){t("Dispatcher: Handling %s content: %s","OFFERS_DATA",o);var f=window.LIBRO.content.attributes.offers;if(f){var n=o.eligibleSubCount,s=o.eligibleSubs.split(","),a=JSON.parse(f)[0],i=e.dom.getElement(".offers-comp"),_=e.dom.getElements(".offers--hidden");e.dom.removeClass(_,"offers--hidden");var c=e.dom.getElement(i,".offers__container");e.dom.addClass(c,"offers-count--".concat(n)),function(t,r,o){var f,n,s=e.store.getData().data.user.user_loggedinalias,a=JSON.parse(r.marketing_offers_teaser)[0],i=a.desc.replace("YOU",s),_=e.dom.getElement(t,".offers__teaser"),c=e.dom.getElement(_,".offers__teaser__title"),l=e.dom.getElement(_,".offers__teaser__desc"),d=e.dom.getElement(_,".offers__tease__cta"),m=(f=o,(n=a.cta_label.split(" ")).splice(1,0,f.toString()),n.join(" "));c.innerText=a.title,l.innerText=i,d.innerHTML="<span>"+m+"</span>"}(i,a,n),function(t,r,o){var f=e.dom.getElement(t,".offers__header__title"),n=e.dom.getElement(t,".offers__header__desc"),s=JSON.parse(r.marketing_offers_descs),a=JSON.parse(s[0].descriptions);f.innerText=r.marketing_offers_title,n.innerHTML=a[o-1].title}(i,a,n),function(t,r){var o=t.marketing_offers_img,f=t.marketing_offers_img2x,n=t.marketing_offers_img_large,s=t.marketing_offers_img_large2x,a=3===r?"".concat(o,", ").concat(f," 2x"):"".concat(n,", ").concat(s," 2x");e.dom.setAttribute(".offers__figure__img","srcset",a)}(a,n),function(t,r,o,f){o.forEach((function(o,n){var s=r.filter((function(e){return o===e.marketing_offerid})),a=n+1;s.forEach((function(r){!function(t,r){e.dom.setAttribute(".offers__offer--".concat(t," .offers__offer__logo__img"),"src",r)}(a,r.logo),function(r,o){e.dom.getElement(t,".offers__offer--".concat(r," .offers__offer__desc")).innerHTML=o}(a,r.desc),function(r,o){var n=JSON.parse(o);e.dom.setAttribute(".offers__offer--".concat(r," .offers__offer__logo"),"href",n[1].cta_url+"?ncid="+f),e.dom.getElement(t,".offers__offer--".concat(r," .offers_offer_cta1")).innerHTML="<span>".concat(n[0].cta_label,"</span>"),e.dom.setAttribute(".offers__offer--".concat(r," .offers_offer_cta1"),"href",n[0].cta_url+"&ncid="+f),e.dom.getElement(t,".offers__offer--".concat(r," .offers_offer_cta2")).innerHTML="<span>".concat(n[1].cta_label,"</span>"),e.dom.setAttribute(".offers__offer--".concat(r," .offers_offer_cta2"),"href",n[1].cta_url+"?ncid="+f)}(a,r.buttons)}))}))}(i,JSON.parse(a.marketing_offers_offers),s,o.ncid),r(),function(){t("Handling %s event","PAGE_LOADED");try{e.rapid.initializeViewabilityTracking("#offers","offers")}catch(e){t(e)}}()}}))}(LIBRO.common);